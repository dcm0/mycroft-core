<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tama Page</title>

    <script type="text/javascript">
        // Let us open a web socket
        var ws = new WebSocket("ws://130.237.158.145:8181/core");
        ws.onmessage = recieverFunction();

        function recieverFunction(evt) {
            var received_msg = evt.data;
            var received_msg = JSON.parse(evt.data); // the whole json
            document.getElementById("info").value = document.getElementById("info").value + "\n" + evt.data;
            document.getElementById("info").value = document.getElementById("info").value + "\n" + received_msg.type;
            if (received_msg.type == "enclosure.eyes.lookstatus") {
                alert(received_msg.data["data"]);
                result = received_msg.data["data"];
                autoFlag = result == "true" ? true : false;
                document.getElementById("info").checked = autoFlag;

                //alert("Message is received..."+evt.data)

            }
        }


        function SpeakTest() {
            // Web Socket is connected, send data using send()
            var msg = {
                type: 'speak',
                data: { 'utterance': 'Hi my name is Tama, what is your name.' },
                end: '',
                context: { destination: '' }
            };
            ws.send(JSON.stringify(msg))
        }


        function ChangeColor() {

            var msg = {
                type: 'enclosure.eyes.color',
                data: { 'r': 255, 'g': 0, 'b': 0 },
                end: '',
                context: { destination: '' }
            };
            ws.send(JSON.stringify(msg))

        }




        function ChangeHeadPos() {

            var msg = {
                type: 'enclosure.head.move',
                data: { 'pos': -30 },
                end: '',
                context: { destination: '' }
            };
            ws.send(JSON.stringify(msg))

        }


        function AutoHead() {

            ws.send("Message to send");
            var msg = {
                type: 'enclosure.eyes.toggleAutolook',
                data: '',
                end: '',
                context: { destination: '' }
            };
            ws.send(JSON.stringify(msg))
        }

    </script>







</head>

<body>
    <h1>Tama control station</h1>

    <input type="checkbox" onClick="AutoHead()" id="AutoHead" checked>Auto head</input>
    <button type="button" onClick="SpeakTest()">Speak</button>
    <button type="button" onClick="ChangeColor()">Change eye color</button>
    <button type="button" onclick="ChangeHeadPos()">Move head</button>
    <br>
    <textarea id="info" name="info" rows="10" cols="50"></textarea>





</body>

</html>